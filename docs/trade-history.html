<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>STOCK_PREDICTOR v1.0 | Trade History</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=JetBrains+Mono:wght@400;700&display=swap');

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            background: #0a0a0a;
            color: #00ff00;
            min-height: 100vh;
            padding: 20px;
            line-height: 1.6;
        }

        .terminal-container {
            max-width: 1400px;
            margin: 0 auto;
            border: 2px solid #00ff00;
            background: #000000;
            box-shadow: 0 0 20px rgba(0, 255, 0, 0.3);
        }

        .terminal-header {
            background: #00ff00;
            color: #000;
            padding: 10px 20px;
            font-weight: bold;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .terminal-title {
            font-size: 1.2em;
        }

        .terminal-time {
            font-size: 0.9em;
        }

        .terminal-nav {
            background: #111;
            border-bottom: 1px solid #00ff00;
            padding: 15px 20px;
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
        }

        .nav-link {
            color: #00ff00;
            text-decoration: none;
            position: relative;
            transition: all 0.3s;
            font-weight: bold;
            text-shadow: 0 0 5px #00ff00;
            font-size: 0.9em;
        }

        .nav-link:hover {
            color: #ffffff;
            text-shadow: 0 0 15px #00ff00;
            background: #003300;
            padding: 5px 10px;
            border-radius: 3px;
        }

        .nav-link.active::before {
            content: '[';
            position: absolute;
            left: -10px;
        }

        .nav-link.active::after {
            content: ']';
            position: absolute;
            right: -10px;
        }

        .terminal-body {
            padding: 30px;
        }

        .section-title {
            color: #00ff00;
            font-size: 1.5em;
            margin-bottom: 20px;
            border-bottom: 1px solid #00ff00;
            padding-bottom: 10px;
        }

        .section-title::before {
            content: '> ';
        }

        .filter-controls {
            background: #111;
            border: 1px solid #00ff00;
            padding: 20px;
            margin-bottom: 30px;
            border-radius: 5px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
            gap: 5px;
        }

        .filter-label {
            color: #00ff00;
            font-size: 0.9em;
            font-weight: bold;
        }

        .filter-input {
            background: #000;
            border: 1px solid #00ff00;
            color: #00ff00;
            padding: 8px;
            font-family: 'JetBrains Mono', monospace;
            border-radius: 3px;
        }

        .filter-input:focus {
            outline: none;
            box-shadow: 0 0 5px rgba(0, 255, 0, 0.5);
        }

        .performance-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 15px;
            margin-bottom: 30px;
        }

        .perf-card {
            background: #111;
            border: 1px solid #00ff00;
            padding: 15px;
            text-align: center;
            border-radius: 5px;
        }

        .perf-label {
            color: #008800;
            font-size: 0.8em;
            margin-bottom: 5px;
        }

        .perf-value {
            font-size: 1.4em;
            font-weight: bold;
            color: #00ff00;
        }

        .perf-value.positive {
            color: #00ff00;
        }

        .perf-value.negative {
            color: #ff4444;
        }

        .trades-table {
            width: 100%;
            border-collapse: collapse;
            margin-bottom: 30px;
            background: #111;
            border: 1px solid #00ff00;
        }

        .trades-table th {
            background: #00ff00;
            color: #000;
            padding: 10px 6px;
            text-align: left;
            font-weight: bold;
            font-size: 0.85em;
        }

        .trades-table td {
            border: 1px solid #003300;
            padding: 8px 6px;
            color: #00ff00;
            font-size: 0.85em;
        }

        .trades-table tr:hover {
            background: #001100;
        }

        .trade-row.winner {
            border-left: 3px solid #00ff00;
        }

        .trade-row.loser {
            border-left: 3px solid #ff4444;
        }

        .symbol-cell {
            font-weight: bold;
        }

        .position-long {
            color: #00ff00;
            font-weight: bold;
        }

        .position-short {
            color: #ff8800;
            font-weight: bold;
        }

        .return-positive {
            color: #00ff00;
            font-weight: bold;
        }

        .return-negative {
            color: #ff4444;
            font-weight: bold;
        }

        .exit-reason {
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 0.75em;
            font-weight: bold;
        }

        .reason-target {
            background: #00ff00;
            color: #000;
        }

        .reason-stop {
            background: #ff4444;
            color: #fff;
        }

        .reason-time {
            background: #ffff00;
            color: #000;
        }

        .pagination {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 30px;
        }

        .page-btn {
            background: #003300;
            color: #00ff00;
            border: 1px solid #00ff00;
            padding: 8px 12px;
            font-family: 'JetBrains Mono', monospace;
            cursor: pointer;
            border-radius: 3px;
            transition: all 0.3s;
        }

        .page-btn:hover,
        .page-btn.active {
            background: #00ff00;
            color: #000;
        }

        .page-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }

        .trade-details-modal {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.9);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .modal-content {
            background: #000;
            border: 2px solid #00ff00;
            padding: 30px;
            max-width: 600px;
            width: 90%;
            max-height: 80vh;
            overflow-y: auto;
            border-radius: 5px;
        }

        .modal-close {
            position: absolute;
            top: 10px;
            right: 15px;
            background: none;
            border: none;
            color: #00ff00;
            font-size: 1.5em;
            cursor: pointer;
        }

        .trade-chart-placeholder {
            background: #111;
            border: 1px solid #003300;
            height: 200px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #008800;
            margin: 20px 0;
        }

        .export-controls {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }

        .export-btn {
            background: #00ff00;
            color: #000;
            border: none;
            padding: 8px 16px;
            font-family: 'JetBrains Mono', monospace;
            font-weight: bold;
            cursor: pointer;
            border-radius: 3px;
            font-size: 0.9em;
        }

        .export-btn:hover {
            background: #ffffff;
        }

        .loading {
            color: #00ff00;
            text-align: center;
            padding: 50px;
        }

        .loading::after {
            content: '...';
            animation: dots 1.5s infinite;
        }

        @keyframes dots {
            0%, 20% { content: '.'; }
            40% { content: '..'; }
            60%, 100% { content: '...'; }
        }

        .footer {
            text-align: center;
            padding: 20px;
            border-top: 1px solid #00ff00;
            color: #008800;
            font-size: 0.9em;
        }

        /* Mobile Responsiveness */
        @media (max-width: 768px) {
            body {
                padding: 10px;
            }

            .terminal-nav {
                gap: 10px;
            }

            .nav-link {
                font-size: 0.8em;
            }

            .filter-controls {
                grid-template-columns: 1fr;
            }

            .performance-summary {
                grid-template-columns: repeat(2, 1fr);
            }

            .trades-table {
                font-size: 0.75em;
            }

            .trades-table th,
            .trades-table td {
                padding: 6px 3px;
            }

            .export-controls {
                justify-content: center;
            }

            .modal-content {
                padding: 20px;
                width: 95%;
            }
        }
    </style>
</head>
<body>
    <div class="terminal-container">
        <div class="terminal-header">
            <div class="terminal-title">STOCK_PREDICTOR_v1.0_TRADE_HISTORY</div>
            <div class="terminal-time" id="currentTime"></div>
        </div>

        <div class="terminal-nav">
            <a href="../index.html" class="nav-link">HOME</a>
            <a href="../predictions.html" class="nav-link">PREDICTIONS</a>
            <a href="charts.html" class="nav-link">ANALYTICS</a>
            <a href="strategies.html" class="nav-link">STRATEGIES</a>
            <a href="entry-tracker.html" class="nav-link">ENTRY_TRACKER</a>
            <a href="positions.html" class="nav-link">LIVE_POSITIONS</a>
            <a href="trade-history.html" class="nav-link active">TRADE_HISTORY</a>
            <a href="../historic.html" class="nav-link">HISTORIC</a>
        </div>

        <div class="terminal-body">
            <h1 class="section-title">TRADE HISTORY & ANALYSIS</h1>

            <!-- Export Controls -->
            <div class="export-controls">
                <button class="export-btn" onclick="exportToCSV()">EXPORT_CSV</button>
                <button class="export-btn" onclick="exportToJSON()">EXPORT_JSON</button>
                <button class="export-btn" onclick="generateReport()">GENERATE_REPORT</button>
            </div>

            <!-- Filter Controls -->
            <div class="filter-controls">
                <div class="filter-group">
                    <label class="filter-label">DATE_FROM</label>
                    <input type="date" class="filter-input" id="dateFrom">
                </div>
                <div class="filter-group">
                    <label class="filter-label">DATE_TO</label>
                    <input type="date" class="filter-input" id="dateTo">
                </div>
                <div class="filter-group">
                    <label class="filter-label">SYMBOL</label>
                    <select class="filter-input" id="symbolFilter">
                        <option value="">ALL_SYMBOLS</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">STRATEGY</label>
                    <select class="filter-input" id="strategyFilter">
                        <option value="">ALL_STRATEGIES</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">POSITION</label>
                    <select class="filter-input" id="positionFilter">
                        <option value="">ALL_POSITIONS</option>
                        <option value="LONG">LONG_ONLY</option>
                        <option value="SHORT">SHORT_ONLY</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label class="filter-label">OUTCOME</label>
                    <select class="filter-input" id="outcomeFilter">
                        <option value="">ALL_OUTCOMES</option>
                        <option value="winner">WINNERS_ONLY</option>
                        <option value="loser">LOSERS_ONLY</option>
                    </select>
                </div>
            </div>

            <!-- Performance Summary -->
            <div class="performance-summary" id="performanceSummary">
                <div class="loading">Loading performance data</div>
            </div>

            <!-- Pagination -->
            <div class="pagination" id="pagination">
                <button class="page-btn" onclick="changePage(-1)">â—€ PREV</button>
                <span id="pageInfo" style="color: #00ff00; align-self: center;">Page 1 of 1</span>
                <button class="page-btn" onclick="changePage(1)">NEXT â–¶</button>
            </div>

            <!-- Trades Table -->
            <table class="trades-table">
                <thead>
                    <tr>
                        <th>ENTRY_DATE</th>
                        <th>EXIT_DATE</th>
                        <th>SYMBOL</th>
                        <th>POS</th>
                        <th>STRATEGY</th>
                        <th>ENTRY</th>
                        <th>EXIT</th>
                        <th>TARGET</th>
                        <th>STOP</th>
                        <th>RETURN</th>
                        <th>DAYS</th>
                        <th>EXIT_REASON</th>
                        <th>ACTION</th>
                    </tr>
                </thead>
                <tbody id="tradesTableBody">
                    <tr><td colspan="13" class="loading">Loading trade history</td></tr>
                </tbody>
            </table>

            <!-- Trade Details Modal -->
            <div class="trade-details-modal" id="tradeModal">
                <div class="modal-content">
                    <button class="modal-close" onclick="closeTradeModal()">Ã—</button>
                    <h2 style="color: #00ff00; margin-bottom: 20px;">TRADE DETAILS</h2>
                    <div id="tradeDetails">
                        <!-- Trade details will be populated here -->
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            COMPREHENSIVE TRADE HISTORY | PERFORMANCE ANALYSIS | <a href="https://github.com/yourusername/stock-predictor" style="color: #00ff00;">GITHUB</a>
        </div>
    </div>

    <script>
        // Global variables
        let tradesData = null;
        let filteredTrades = [];
        let currentPage = 1;
        let tradesPerPage = 25;

        // Update current time
        function updateTime() {
            const now = new Date();
            document.getElementById('currentTime').textContent = now.toLocaleString();
        }
        updateTime();
        setInterval(updateTime, 1000);

        // Load trades data
        async function loadTradesData() {
            try {
                const response = await fetch('../trades_data.json');
                tradesData = await response.json();
            } catch (error) {
                console.error('Error loading trades data:', error);
                tradesData = generateSampleTradesData();
            }

            populateFilterOptions();
            applyFilters();
        }

        // Generate sample trades data
        function generateSampleTradesData() {
            const closedTrades = [];
            const stocks = ['AAPL', 'MSFT', 'GOOGL', 'NVDA', 'TSLA', 'META', 'AMZN', 'JPM', 'JNJ', 'BRK-B'];
            const strategies = ['momentum', 'mean_reversion', 'volume_breakout', 'technical_indicators', 'pattern_recognition', 'volatility_arbitrage', 'moving_average_crossover', 'support_resistance', 'market_sentiment', 'ensemble'];

            for (let i = 0; i < 150; i++) {
                const entryDate = new Date(Date.now() - Math.random() * 90 * 24 * 60 * 60 * 1000);
                const daysHeld = Math.floor(Math.random() * 14) + 1;
                const exitDate = new Date(entryDate.getTime() + daysHeld * 24 * 60 * 60 * 1000);

                const entryPrice = Math.random() * 300 + 50;
                const isLong = Math.random() > 0.5;
                const returnPct = (Math.random() - 0.4) * 20; // Bias slightly positive

                const exitReasons = ['TARGET', 'STOP_LOSS', 'TIME_EXIT'];
                const exitReason = returnPct > 5 ? 'TARGET' : returnPct < -3 ? 'STOP_LOSS' : 'TIME_EXIT';

                const exitPrice = isLong ?
                    entryPrice * (1 + returnPct / 100) :
                    entryPrice * (1 - returnPct / 100);

                closedTrades.push({
                    symbol: stocks[Math.floor(Math.random() * stocks.length)],
                    strategy: strategies[Math.floor(Math.random() * strategies.length)],
                    position: isLong ? 'LONG' : 'SHORT',
                    entry_price: entryPrice,
                    exit_price: exitPrice,
                    target_price: isLong ? entryPrice * 1.08 : entryPrice * 0.92,
                    stop_loss_price: isLong ? entryPrice * 0.95 : entryPrice * 1.05,
                    entry_date: entryDate.toISOString().split('T')[0],
                    exit_date: exitDate.toISOString().split('T')[0],
                    return_pct: returnPct,
                    days_held: daysHeld,
                    exit_reason: exitReason,
                    status: 'CLOSED'
                });
            }

            return {
                active_trades: [],
                closed_trades: closedTrades
            };
        }

        // Populate filter dropdown options
        function populateFilterOptions() {
            const symbols = [...new Set(tradesData.closed_trades.map(t => t.symbol))].sort();
            const strategies = [...new Set(tradesData.closed_trades.map(t => t.strategy))].sort();

            const symbolFilter = document.getElementById('symbolFilter');
            const strategyFilter = document.getElementById('strategyFilter');

            symbols.forEach(symbol => {
                const option = document.createElement('option');
                option.value = symbol;
                option.textContent = symbol;
                symbolFilter.appendChild(option);
            });

            strategies.forEach(strategy => {
                const option = document.createElement('option');
                option.value = strategy;
                option.textContent = strategy.replace('_', ' ').toUpperCase();
                strategyFilter.appendChild(option);
            });

            // Add event listeners for filtering
            ['dateFrom', 'dateTo', 'symbolFilter', 'strategyFilter', 'positionFilter', 'outcomeFilter'].forEach(id => {
                document.getElementById(id).addEventListener('change', applyFilters);
            });
        }

        // Apply filters to trades data
        function applyFilters() {
            let filtered = [...tradesData.closed_trades];

            // Date filters
            const dateFrom = document.getElementById('dateFrom').value;
            const dateTo = document.getElementById('dateTo').value;

            if (dateFrom) {
                filtered = filtered.filter(trade => trade.entry_date >= dateFrom);
            }
            if (dateTo) {
                filtered = filtered.filter(trade => trade.entry_date <= dateTo);
            }

            // Symbol filter
            const symbolFilter = document.getElementById('symbolFilter').value;
            if (symbolFilter) {
                filtered = filtered.filter(trade => trade.symbol === symbolFilter);
            }

            // Strategy filter
            const strategyFilter = document.getElementById('strategyFilter').value;
            if (strategyFilter) {
                filtered = filtered.filter(trade => trade.strategy === strategyFilter);
            }

            // Position filter
            const positionFilter = document.getElementById('positionFilter').value;
            if (positionFilter) {
                filtered = filtered.filter(trade => trade.position === positionFilter);
            }

            // Outcome filter
            const outcomeFilter = document.getElementById('outcomeFilter').value;
            if (outcomeFilter) {
                if (outcomeFilter === 'winner') {
                    filtered = filtered.filter(trade => trade.return_pct > 0);
                } else if (outcomeFilter === 'loser') {
                    filtered = filtered.filter(trade => trade.return_pct <= 0);
                }
            }

            filteredTrades = filtered.sort((a, b) => new Date(b.exit_date) - new Date(a.exit_date));
            currentPage = 1;
            updatePerformanceSummary();
            updateTradesTable();
            updatePagination();
        }

        // Update performance summary
        function updatePerformanceSummary() {
            const trades = filteredTrades;
            const winners = trades.filter(t => t.return_pct > 0);
            const losers = trades.filter(t => t.return_pct <= 0);

            const totalReturn = trades.reduce((sum, t) => sum + t.return_pct, 0);
            const avgReturn = trades.length > 0 ? totalReturn / trades.length : 0;
            const winRate = trades.length > 0 ? (winners.length / trades.length) * 100 : 0;
            const avgWin = winners.length > 0 ? winners.reduce((sum, t) => sum + t.return_pct, 0) / winners.length : 0;
            const avgLoss = losers.length > 0 ? losers.reduce((sum, t) => sum + t.return_pct, 0) / losers.length : 0;
            const profitFactor = losers.length > 0 ? Math.abs(winners.reduce((sum, t) => sum + t.return_pct, 0) / losers.reduce((sum, t) => sum + t.return_pct, 0)) : 0;
            const bestTrade = trades.length > 0 ? Math.max(...trades.map(t => t.return_pct)) : 0;
            const worstTrade = trades.length > 0 ? Math.min(...trades.map(t => t.return_pct)) : 0;

            const summaryHtml = `
                <div class="perf-card">
                    <div class="perf-label">TOTAL_TRADES</div>
                    <div class="perf-value">${trades.length}</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">WIN_RATE</div>
                    <div class="perf-value">${winRate.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">TOTAL_RETURN</div>
                    <div class="perf-value ${totalReturn >= 0 ? 'positive' : 'negative'}">${totalReturn >= 0 ? '+' : ''}${totalReturn.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">AVG_RETURN</div>
                    <div class="perf-value ${avgReturn >= 0 ? 'positive' : 'negative'}">${avgReturn >= 0 ? '+' : ''}${avgReturn.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">AVG_WIN</div>
                    <div class="perf-value positive">+${avgWin.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">AVG_LOSS</div>
                    <div class="perf-value negative">${avgLoss.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">PROFIT_FACTOR</div>
                    <div class="perf-value">${profitFactor.toFixed(2)}</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">BEST_TRADE</div>
                    <div class="perf-value positive">+${bestTrade.toFixed(1)}%</div>
                </div>
                <div class="perf-card">
                    <div class="perf-label">WORST_TRADE</div>
                    <div class="perf-value negative">${worstTrade.toFixed(1)}%</div>
                </div>
            `;

            document.getElementById('performanceSummary').innerHTML = summaryHtml;
        }

        // Update trades table
        function updateTradesTable() {
            const startIndex = (currentPage - 1) * tradesPerPage;
            const endIndex = startIndex + tradesPerPage;
            const pageData = filteredTrades.slice(startIndex, endIndex);

            const tableBody = document.getElementById('tradesTableBody');

            if (pageData.length === 0) {
                tableBody.innerHTML = '<tr><td colspan="13" style="text-align: center; color: #008800;">No trades match your filters</td></tr>';
                return;
            }

            tableBody.innerHTML = pageData.map(trade => {
                const returnClass = trade.return_pct >= 0 ? 'return-positive' : 'return-negative';
                const rowClass = trade.return_pct >= 0 ? 'winner' : 'loser';
                const positionClass = trade.position === 'LONG' ? 'position-long' : 'position-short';

                let exitReasonClass = 'reason-time';
                if (trade.exit_reason === 'TARGET') exitReasonClass = 'reason-target';
                else if (trade.exit_reason === 'STOP_LOSS') exitReasonClass = 'reason-stop';

                return `
                    <tr class="trade-row ${rowClass}">
                        <td>${trade.entry_date}</td>
                        <td>${trade.exit_date}</td>
                        <td class="symbol-cell">${trade.symbol}</td>
                        <td class="${positionClass}">${trade.position}</td>
                        <td>${trade.strategy.replace('_', ' ').toUpperCase()}</td>
                        <td>$${trade.entry_price.toFixed(2)}</td>
                        <td>$${trade.exit_price.toFixed(2)}</td>
                        <td>$${trade.target_price.toFixed(2)}</td>
                        <td>$${trade.stop_loss_price.toFixed(2)}</td>
                        <td class="${returnClass}">${trade.return_pct >= 0 ? '+' : ''}${trade.return_pct.toFixed(1)}%</td>
                        <td>${trade.days_held}</td>
                        <td><span class="exit-reason ${exitReasonClass}">${trade.exit_reason}</span></td>
                        <td><button class="page-btn" onclick="viewTradeDetails('${trade.symbol}_${trade.entry_date}')">VIEW</button></td>
                    </tr>
                `;
            }).join('');
        }

        // Update pagination
        function updatePagination() {
            const totalPages = Math.ceil(filteredTrades.length / tradesPerPage);
            document.getElementById('pageInfo').textContent = `Page ${currentPage} of ${totalPages}`;

            const prevBtn = document.querySelector('.pagination button:first-child');
            const nextBtn = document.querySelector('.pagination button:last-child');

            prevBtn.disabled = currentPage === 1;
            nextBtn.disabled = currentPage === totalPages;
        }

        // Change page
        function changePage(direction) {
            const totalPages = Math.ceil(filteredTrades.length / tradesPerPage);
            const newPage = currentPage + direction;

            if (newPage >= 1 && newPage <= totalPages) {
                currentPage = newPage;
                updateTradesTable();
                updatePagination();
            }
        }

        // View trade details
        function viewTradeDetails(tradeId) {
            // For demo purposes, show modal with sample data
            const modal = document.getElementById('tradeModal');
            const details = document.getElementById('tradeDetails');

            details.innerHTML = `
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                    <div>
                        <h3 style="color: #00ff00; margin-bottom: 10px;">TRADE SUMMARY</h3>
                        <div><strong>Trade ID:</strong> ${tradeId}</div>
                        <div><strong>Symbol:</strong> AAPL</div>
                        <div><strong>Position:</strong> LONG</div>
                        <div><strong>Strategy:</strong> MOMENTUM</div>
                        <div><strong>Entry Date:</strong> 2024-01-15</div>
                        <div><strong>Exit Date:</strong> 2024-01-22</div>
                    </div>
                    <div>
                        <h3 style="color: #00ff00; margin-bottom: 10px;">PRICE LEVELS</h3>
                        <div><strong>Entry Price:</strong> $185.23</div>
                        <div><strong>Exit Price:</strong> $197.45</div>
                        <div><strong>Target Price:</strong> $200.05</div>
                        <div><strong>Stop Loss:</strong> $175.97</div>
                        <div><strong>Return:</strong> <span style="color: #00ff00;">+6.6%</span></div>
                    </div>
                </div>

                <div class="trade-chart-placeholder">
                    ðŸ“ˆ PRICE CHART WOULD BE DISPLAYED HERE
                </div>

                <div>
                    <h3 style="color: #00ff00; margin-bottom: 10px;">TRADE NOTES</h3>
                    <div style="background: #111; padding: 15px; border: 1px solid #003300; border-radius: 3px;">
                        Strong momentum breakout above 20-day SMA with high volume confirmation.
                        RSI indicated oversold condition with bullish divergence.
                        Exited near target as momentum began to fade.
                    </div>
                </div>
            `;

            modal.style.display = 'flex';
        }

        // Close trade modal
        function closeTradeModal() {
            document.getElementById('tradeModal').style.display = 'none';
        }

        // Export functions
        function exportToCSV() {
            const csv = convertToCSV(filteredTrades);
            downloadFile(csv, 'trade_history.csv', 'text/csv');
        }

        function exportToJSON() {
            const json = JSON.stringify(filteredTrades, null, 2);
            downloadFile(json, 'trade_history.json', 'application/json');
        }

        function generateReport() {
            alert('Generating comprehensive PDF report... (This would generate a detailed performance report)');
        }

        function convertToCSV(trades) {
            const headers = ['Entry Date', 'Exit Date', 'Symbol', 'Position', 'Strategy', 'Entry Price', 'Exit Price', 'Target Price', 'Stop Loss', 'Return %', 'Days Held', 'Exit Reason'];
            const rows = trades.map(trade => [
                trade.entry_date,
                trade.exit_date,
                trade.symbol,
                trade.position,
                trade.strategy,
                trade.entry_price.toFixed(2),
                trade.exit_price.toFixed(2),
                trade.target_price.toFixed(2),
                trade.stop_loss_price.toFixed(2),
                trade.return_pct.toFixed(2),
                trade.days_held,
                trade.exit_reason
            ]);

            return [headers, ...rows].map(row => row.join(',')).join('\n');
        }

        function downloadFile(content, filename, mimeType) {
            const blob = new Blob([content], { type: mimeType });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = filename;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
        }

        // Initialize page
        document.addEventListener('DOMContentLoaded', loadTradesData);

        // Close modal when clicking outside
        document.getElementById('tradeModal').addEventListener('click', (e) => {
            if (e.target === e.currentTarget) {
                closeTradeModal();
            }
        });
    </script>
</body>
</html>